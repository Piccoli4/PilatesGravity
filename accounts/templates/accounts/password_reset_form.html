{% extends 'accounts/base.html' %}
{% load static %}

{% block title %}Restablecer Contraseña - Pilates Gravity{% endblock %}

{% block content %}
    <!-- Header del formulario -->
    <div class="text-center mb-8">
        <div class="w-14 h-14 mx-auto mb-4 text-principal animate-iconPulse">
            <svg width="60" height="60" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full h-full">
                <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM12 17c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM15.1 8H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z" fill="currentColor"/>
            </svg>
        </div>
        <h2 class="text-3xl font-bold text-principal mb-3 tracking-wide">Restablecer Contraseña</h2>
        <p class="text-base text-gris-medio font-light opacity-90 leading-relaxed">
            Te enviaremos un enlace para crear una nueva contraseña
        </p>
        <div class="w-20 h-0.5 bg-gradient-to-r from-secundario to-principal mx-auto mt-4 rounded-full"></div>
    </div>

    <form method="post" class="space-y-6">
        {% csrf_token %}
        
        <div class="form-field-group opacity-0 translate-y-5">
            <label for="id_email" class="block text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2">
                <span class="text-lg">📧</span>
                Correo electrónico
            </label>
            <div class="relative">
                <input type="email" 
                       name="{{ form.email.name }}" 
                       id="id_email" 
                       class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl text-base bg-gris-claro transition-all duration-300 focus:border-principal focus:outline-none focus:ring-4 focus:ring-principal/10 focus:bg-white focus:-translate-y-0.5 hover:border-secundario"
                       placeholder="tu.email@ejemplo.com"
                       value="{{ form.email.value|default:'' }}"
                       required>
                <div class="absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-secundario to-principal scale-x-0 transition-transform duration-300 rounded-full input-focus-line"></div>
            </div>
            {% if form.email.errors %}
                <div class="mt-2 space-y-1">
                    {% for error in form.email.errors %}
                        <span class="block text-error text-sm flex items-center gap-1 animate-slideInError">
                            ⚠️ {{ error }}
                        </span>
                    {% endfor %}
                </div>
            {% endif %}
            {% if form.email.help_text %}
                <div class="mt-3 flex items-start gap-2 p-3 bg-blue-50 rounded-lg border-l-4 border-info">
                    <span class="text-base flex-shrink-0 mt-0.5">💡</span>
                    <span class="text-sm text-principal opacity-80 leading-relaxed">{{ form.email.help_text }}</span>
                </div>
            {% endif %}
        </div>

        <div class="form-submit-section opacity-0 translate-y-5">
            <button type="submit" class="reset-submit-btn w-full bg-gradient-to-r from-principal to-slate-600 text-white border-none rounded-xl px-8 py-4 text-lg font-semibold cursor-pointer transition-all duration-300 relative overflow-hidden shadow-btn-primary hover:shadow-btn-primary-hover hover:-translate-y-1 focus:outline-none focus:ring-4 focus:ring-principal/25">
                <span class="relative z-10 flex items-center justify-center gap-3">
                    <span>Enviar Enlace</span>
                    <span class="text-xl">📤</span>
                </span>
            </button>
        </div>
    </form>

    <div class="mt-8 text-center">
        <div class="relative flex items-center justify-center mb-6">
            <div class="absolute inset-0 flex items-center">
                <div class="w-full border-t-2 border-gray-200"></div>
            </div>
            <div class="relative bg-blanco px-4">
                <span class="text-sm text-gris-medio font-medium">¿Recordaste tu contraseña?</span>
            </div>
        </div>
        <a href="{% url 'accounts:login' %}" 
           class="inline-flex items-center gap-2 text-principal font-medium text-base hover:text-slate-600 transition-colors duration-300 hover:no-underline">
            <span class="text-lg">🔙</span>
            Volver al inicio de sesión
        </a>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Animación de entrada escalonada
            const formElements = document.querySelectorAll('.form-field-group, .form-submit-section');
            formElements.forEach((element, index) => {
                setTimeout(() => {
                    element.style.transition = 'all 0.6s ease';
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(0)';
                }, 200 * index);
            });

            // Efecto de focus en input
            const emailInput = document.getElementById('id_email');
            const focusLine = document.querySelector('.input-focus-line');
            
            if (emailInput && focusLine) {
                emailInput.addEventListener('focus', function() {
                    focusLine.style.transform = 'scaleX(1)';
                });
                
                emailInput.addEventListener('blur', function() {
                    focusLine.style.transform = 'scaleX(0)';
                });
            }

            // Efecto de envío del formulario
            const form = document.querySelector('form');
            const submitBtn = document.querySelector('.reset-submit-btn');
            
            if (form && submitBtn) {
                form.addEventListener('submit', function() {
                    submitBtn.innerHTML = `
                        <span class="relative z-10 flex items-center justify-center gap-3">
                            <span class="loading-spinner"></span>
                            <span>Enviando...</span>
                        </span>
                    `;
                    submitBtn.disabled = true;
                });
            }
        });
    </script>
{% endblock %}